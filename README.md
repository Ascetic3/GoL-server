
"""
# Game of Life 

Актуальная версия репозитория содержит несколько реализаций симуляции "Игра Жизнь" Конвея на Go, визуализаторы на Python и простой TCP‑сервер, который принимает JSON‑запросы, запускает симуляцию и сохраняет результат в файл.
## Участники проекта и их роли
Таня Соколова — тестировщик: Acorn/Блок/LWSS, дооформление отчёта

Полина Алиева — тестировщик: Блинкер/Toad/R-pentomino

Маша Кноль — тестировщик: Bacon/Glider/Hive

Владислав Шалунов — разработчик, оформление отчёта

## Что есть в репозитории

- `single_iteration/` — реализация, выполняющая одну итерацию.
   - `template.go` — код для одной итерации.
   - `GoL-viewer.py` — Python визуализатор для одного состояния.
- `multi_iteration/` — реализация, прогоняющая несколько итераций и сохраняющая последовательность состояний.
   - `template.go` — код для множественных итераций (используется в тестах и в переключении режимов).
   - `GoL-viewer.py` — анимационный визуализатор (pygame).
- `patterns/` — текстовые файлы с готовыми паттернами (glider, blinker и т.д.).
- `states/` — примеры сгенерированных состояний (multi_iteration).
- `Пример совместного использования/` — учебные примеры клиента и сервера (оставлены без изменений).
- `tcp_server_gol/` — новая папка с простым TCP‑сервером и клиентом для тестирования по JSON:
   - `gol_server.go` — TCP‑сервер: принимает JSON, кладёт строку в канал, worker парсит и выполняет симуляцию, сохраняет результат в файл.
   - `client/` — интерактивный пример клиента `main.go`, который показывает пресеты, отправляет выбранный JSON и ждёт ответа.
- `Game_of_Life(1)` - отчёт о проекте

## TCP‑сервер: 

Сервер реализован в `tcp_server_gol/gol_server.go` и слушает `localhost:8000`.

- Клиент должен прислать ровно один JSON (байты) и закрыть сторону записи соединения (или полностью соединение). Сервер в обработчике соединения читает все байты (`io.ReadAll`) и передаёт строку в канал `jobs`.
- Одна фоновая горутина `worker` последовательно извлекает сообщения из `jobs`, парсит JSON в структуру `Request`, запускает симуляцию и сохраняет результат в файл `File`.

JSON‑контракт (пример):

```json
{
   "size": 10,
   "live": [[4,5],[5,5],[6,5]],
   "steps": 5,
   "file": "result.txt"
}
```

Поля:
- `size` (int) — размер квадратного поля.
- `live` ([[int,int]]) — список координат живых клеток (кажный элемент — [row, col], 0‑based).
- `steps` (int) — число итераций симуляции (>= 0).
- `file` (string) — имя выходного файла для сохранения финального состояния (перезаписывается).



## Как запустить (Windows PowerShell)

1) Запустить сервер:

```powershell
cd "\Go_live\GoL-server\GoL-server\tcp_server_gol"
go run gol_server.go
```

2) Запустить интерактивного клиента (в другом терминале):

```powershell
go run .\client\main.go
```

Клиент покажет список пресетов (например `blinker`, `glider`, `block`) с номерами. Введите номер и нажмите Enter — клиент отправит JSON и подождёт ответа сервера. Введите `q` чтобы выйти.

Примечание: клиент закрывает сторону записи (`CloseWrite()`), чтобы сервер видел EOF и мог завершить чтение (`io.ReadAll`). Это важно: если клиент просто не закрывает запись, сервер может ждать и получить ошибку `i/o timeout`.

## Примеры тестирования и отладки

- Отправка пресета `glider` из клиентского меню — хорошо демонстрирует длительную симуляцию (увеличьте `steps` в пресете для имитации долгой обработки).


## Работа с паттернами и пресетами (patterns/)

В репозитории есть папка `multi_iteration/patterns/` с готовыми паттернами (glider, blinker, beacon и т.д.). Эти файлы используются утилитой из `multi_iteration` и могут служить как источники пресетов для клиента.

Формат файла паттерна
- Первая строка — целое число, размер квадратной сетки N.
- Далее N строк, каждая содержит N чисел `0` или `1`, разделённых пробелами. `1` — живая клетка, `0` — мёртвая.

Пример (файл `multi_iteration/patterns/glider.txt`):

```
20
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
...
0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0 0 0 0 0
...
```

Как использовать паттерн с `multi_iteration`
- По коду `multi_iteration/template.go` ожидается два опциональных аргумента командной строки: сначала — число итераций (int), второй — имя паттерна (без расширения), который сервер будет искать в `multi_iteration/patterns/`.
- Примеры:
   - Использовать `state.txt` и 20 итераций (по умолчанию):
      ```powershell
      go run template.go
      ```
   - Выполнить 30 итераций с паттерном `glider` (файл `multi_iteration/patterns/glider.txt`):
      ```powershell
      go run template.go 30 glider
      ```

Как добавить свой паттерн
1. Создайте файл `my_pattern.txt` в папке `multi_iteration/patterns/`.
2. Заполните его в описанном формате (первая строка — размер, далее N строк по N чисел 0/1).
3. Запустите:
    ```powershell
    go run template.go 50 my_pattern
    ```

Работа с пресетами в клиенте `tcp_server_gol/client/main.go`
- Текущий интерактивный клиент использует хардкод‑пресеты (в файле `tcp_server_gol/client/main.go`). Чтобы добавить новый пресет в клиент, откройте `client/main.go` и добавьте элемент в `presets`:

```go
{"my_pattern", map[string]interface{}{"size": 10, "live": [][]int{{1,2},{2,3}}, "steps": 50, "file": "out_my_pattern.txt"}},
```
"""

